### Mon, Mar 20th, 2023

**dune73** <span style="color: grey; font-size: 90%;">19:30:11 UTC</span>

<span style="font-size: 90%;">Hey, hey, time for our 2nd monthly chat.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:30:14 UTC</span>

<span style="font-size: 90%;">Welcome everybody.</span>

**emphazer** <span style="color: grey; font-size: 90%;">19:30:30 UTC</span>

<span style="font-size: 90%;">Hello :wave:</span>

**xanadu** <span style="color: grey; font-size: 90%;">19:31:15 UTC</span>

<span style="font-size: 90%;">Hello!</span>

**airween** <span style="color: grey; font-size: 90%;">19:31:31 UTC</span>

<span style="font-size: 90%;">hi there!</span>

**Matteo Pace** <span style="color: grey; font-size: 90%;">19:31:46 UTC</span>

<span style="font-size: 90%;">Hello :)</span>

**theMiddle** <span style="color: grey; font-size: 90%;">19:31:47 UTC</span>

<span style="font-size: 90%;">hello :pinched_fingers:</span>

**franbuehler** <span style="color: grey; font-size: 90%;">19:32:22 UTC</span>

<span style="font-size: 90%;">Hello</span>

**dune73** <span style="color: grey; font-size: 90%;">19:32:31 UTC</span>

<span style="font-size: 90%;">Good to see you all.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:32:53 UTC</span>

<span style="font-size: 90%;">Especially without the pressure of the Bug Bounty on our back. I feel so much lighter around the shoulders.</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">19:33:16 UTC</span>

<span style="font-size: 90%;">That's probably because of all the hair you lost...</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">19:33:32 UTC</span>

<span style="font-size: 90%;">:wink:</span>

**dune73** <span style="color: grey; font-size: 90%;">19:33:20 UTC</span>

<span style="font-size: 90%;">Speaking of: I prepared a lengthy bug bounty journey blog post. It's currently in review with Yahoo and will hit the website sooner or later.</span>

↳ **jit(Xhoenix)** <span style="color: grey; font-size: 90%;">19:34:17 UTC</span>

<span style="font-size: 90%;">Looking forward to it.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:34:14 UTC</span>

<span style="font-size: 90%;">Let's add 2-3 brief news items: First sponsor has paid for 2023.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:35:18 UTC</span>

<span style="font-size: 90%;">Other sponsors are a bit unsure. Financial situation with one of them, one has been acquired, etc. I thought with would not be a big deal for 2023 and now it seems I need to work on this topic nevertheless. But whatever, I am sure we have our dev retreat covered and more projects too.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:35:45 UTC</span>

<span style="font-size: 90%;">Our agenda is at [https://github.com/coreruleset/coreruleset/issues/3039](https://github.com/coreruleset/coreruleset/issues/3039)
(Scroll down a bit.)</span>

**dune73** <span style="color: grey; font-size: 90%;">19:37:15 UTC</span>

<span style="font-size: 90%;">There is a link to a blog post to OWASP member of the board Mark Curphew who had launched an open letter in February. Many project had signed that. We did not - on purpose. The open letter was addresses to the board. The board received it and started to address the issue raised - in the typical slow way of a big organisation. Board member Mark got fed up with the process after a month and quit the board.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:37:26 UTC</span>

<span style="font-size: 90%;">[https://www.linkedin.com/pulse/yesterdays-owasp-board-directors-meeting-i-resigned-my-mark-curphey/](https://www.linkedin.com/pulse/yesterdays-owasp-board-directors-meeting-i-resigned-my-mark-curphey/)</span>

**dune73** <span style="color: grey; font-size: 90%;">19:37:55 UTC</span>

<span style="font-size: 90%;">He states he is thinking about launching a more centralized organization. One with big sponsors paying development.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:38:13 UTC</span>

<span style="font-size: 90%;">There is a chance some big projects that signed the open letter would follow him to that new org.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:40:21 UTC</span>

<span style="font-size: 90%;">_@walter_, _@fzipitria_ and I are observing the situation and we try to steer our little boat between the big waves. There are many arguments in all directions and it's not worth to discuss is here - and very boring and political anyways. But I am linking it so you are aware what's going on with the foundation. If you have questions, ask here or via DM.
Also: There is going to be a call with the executive director and other HQ staff members about CRS and our finances and how to manage them. We are not happy with the way it works and we think we have a point asking for stronger involvement of the project. We'll see if we get that.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:42:44 UTC</span>

<span style="font-size: 90%;">Good. Then let's move back to the agenda and the more technical questions.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:42:58 UTC</span>

<span style="font-size: 90%;">I propose we look at issue [https://github.com/coreruleset/coreruleset/issues/3154](https://github.com/coreruleset/coreruleset/issues/3154)</span>

**dune73** <span style="color: grey; font-size: 90%;">19:43:05 UTC</span>

<span style="font-size: 90%;">It's the plugins again.</span>

**walter** <span style="color: grey; font-size: 90%;">19:45:55 UTC</span>

<span style="font-size: 90%;">(Hello :wave: fell asleep on the couch :sweat_smile:)</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">19:46:35 UTC</span>

<span style="font-size: 90%;">As usual. :smile:</span>

**dune73** <span style="color: grey; font-size: 90%;">19:45:59 UTC</span>

<span style="font-size: 90%;">The problem is: Plugin initialization runs before 901. So if you want to expand on something that happens in 901, you are too early. Yet if you set a CRS variable, then 901 will not initialize the var.
This results in a situation where you need to re-define the default + your extension.

This is of course rather ugly. But then it's also quite rate. E.g. Allowed methods extended for some software in a rule exclusion plugin.

There are basically two options:
</span>

**dune73** <span style="color: grey; font-size: 90%;">19:46:24 UTC</span>

<span style="font-size: 90%;">Did I sum this up correctly, _@maxleske_?</span>

**dune73** <span style="color: grey; font-size: 90%;">19:46:29 UTC</span>

<span style="font-size: 90%;">Anything I missed?</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:46:36 UTC</span>

<span style="font-size: 90%;">Nope, perfect</span>

**xanadu** <span style="color: grey; font-size: 90%;">19:46:38 UTC</span>

<span style="font-size: 90%;">An example would help people understand</span>

**xanadu** <span style="color: grey; font-size: 90%;">19:46:41 UTC</span>

<span style="font-size: 90%;">Maybe</span>

**xanadu** <span style="color: grey; font-size: 90%;">19:46:48 UTC</span>

<span style="font-size: 90%;">(The methods one is good)</span>

**dune73** <span style="color: grey; font-size: 90%;">19:47:08 UTC</span>

<span style="font-size: 90%;">It's the easiest one I can come up with. Do you have another example in mind?</span>

**dune73** <span style="color: grey; font-size: 90%;">19:47:24 UTC</span>

<span style="font-size: 90%;">Restricted file extensions, that are not restricted for a particular piece of software?</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:47:26 UTC</span>

<span style="font-size: 90%;"># Nextcloud uses DAV methods with index.php and remote.php to do many things
# The default ones in ModSecurity are: GET HEAD POST OPTIONS
#
# Looking through the code, and via testing, I found these:
#
# File manager: PUT DELETE MOVE PROPFIND PROPPATCH
# Calendars: REPORT
# Others in the code or js files: PATCH MKCOL MOVE TRACE
# Others that I added just in case, and they seem related:
#   CHECKOUT COPY LOCK MERGE MKACTIVITY UNLOCK.
SecRule REQUEST_FILENAME "@rx /(?:remote|index|public)\.php/" \
    "id:9508130,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.0.0',\
    setvar:'tx.allowed_methods=%{tx.allowed_methods} PUT PATCH CHECKOUT COPY DELETE LOCK MERGE MKACTIVITY MKCOL MOVE PROPFIND PROPPATCH SEARCH UNLOCK REPORT TRACE jsonp'"</span>

**xanadu** <span style="color: grey; font-size: 90%;">19:47:35 UTC</span>

<span style="font-size: 90%;">Perfect</span>

**Paul Beckett** <span style="color: grey; font-size: 90%;">19:48:17 UTC</span>

<span style="font-size: 90%;">Good evening</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:48:24 UTC</span>

<span style="font-size: 90%;">The proposed solution now is to wait for 4.1. For the example above that means we modify the plugin to something like this:</span>

**dune73** <span style="color: grey; font-size: 90%;">19:48:36 UTC</span>

<span style="font-size: 90%;">I'm in team, "let's leave it as is for the time being". But I have to admit, it's ugly. (I refused to acknowledge that as long as I could :slightly_smiling_face: )</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:48:43 UTC</span>

<span style="font-size: 90%;"># Nextcloud uses DAV methods with index.php and remote.php to do many things
# The default ones in ModSecurity are: GET HEAD POST OPTIONS
#
# Looking through the code, and via testing, I found these:
#
# File manager: PUT DELETE MOVE PROPFIND PROPPATCH
# Calendars: REPORT
# Others in the code or js files: PATCH MKCOL MOVE TRACE
# Others that I added just in case, and they seem related:
#   CHECKOUT COPY LOCK MERGE MKACTIVITY UNLOCK.
SecRule REQUEST_FILENAME "@rx /(?:remote|index|public)\.php/" \
    "id:9508130,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    ver:'nextcloud-rule-exclusions-plugin/1.0.0',\
    setvar:'tx.allowed_methods=GET POST OPTIONS HEAD PUT PATCH CHECKOUT COPY DELETE LOCK MERGE MKACTIVITY MKCOL MOVE PROPFIND PROPPATCH SEARCH UNLOCK REPORT TRACE jsonp'"</span>

**dune73** <span style="color: grey; font-size: 90%;">19:48:45 UTC</span>

<span style="font-size: 90%;">Hey _@Paul Beckett_!</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:48:47 UTC</span>

<span style="font-size: 90%;">(note the last line)</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:49:22 UTC</span>

<span style="font-size: 90%;">The arguments for this are:
</span>

**jit(Xhoenix)** <span style="color: grey; font-size: 90%;">19:50:09 UTC</span>

<span style="font-size: 90%;">How about moving the initialization out of the rules folder, as _@azurIt_ suggested?</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:50:30 UTC</span>

<span style="font-size: 90%;">That would be a discussion for 4.1.</span>

**walter** <span style="color: grey; font-size: 90%;">19:50:51 UTC</span>

<span style="font-size: 90%;">This example could even be setvar:'tx.allowed_methods=%{tx.allowed_methods} GET POST OPTIONS HEAD PUT PATCH CHECKOUT COPY DELETE LOCK MERGE MKACTIVITY MKCOL MOVE PROPFIND PROPPATCH SEARCH UNLOCK REPORT TRACE jsonp'"  right? Then it would honor the user’s crs-setup.conf settings as well, as they are made before the plugin runs. (But of course it cannot take anything away from it)</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">19:52:49 UTC</span>

<span style="font-size: 90%;">Yes: crs-setup.conf, but not defaults from 901.</span>

**maxleske** <span style="color: grey; font-size: 90%;">19:51:07 UTC</span>

<span style="font-size: 90%;">Yes</span>

**dune73** <span style="color: grey; font-size: 90%;">19:51:45 UTC</span>

<span style="font-size: 90%;">Moving them out is an option, but it's a huge step. And that is also affected by future recommended rules. I think we should do this together instead of multiple steps that might contradict each other. We need a holistic approach there.</span>

**walter** <span style="color: grey; font-size: 90%;">19:52:39 UTC</span>

<span style="font-size: 90%;">I think it would be very user-unfriendly if we’d change the plugin system between 4.0 and 4.1 … We’d have old plugins, new plugins… Unless it is only affecting a very small number of plugins.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:53:13 UTC</span>

<span style="font-size: 90%;">If we want to clean it up, it's not even quite clear how. We already propose 3 plugin includes. If we move 901 to the higher level, then that's 4. We could also include it all into the crs-setup.conf, but honestly I think that's quite an architecture change, while the plugins are notaffecting the rest of CRS very much so far.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:53:56 UTC</span>

<span style="font-size: 90%;">4.1 is a major release in it's own right. And if we want to make sure we avoid this, then it has to be perfect for 4.0 and I doubt we are able to do that.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:54:09 UTC</span>

<span style="font-size: 90%;">Yet I am confident it affects only a very small number of plugins.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:54:22 UTC</span>

<span style="font-size: 90%;">The plugin should also be able to look at the CRS version and behave differently.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:54:31 UTC</span>

<span style="font-size: 90%;">crs-setup.conf runs before plugin-conf.</span>

**walter** <span style="color: grey; font-size: 90%;">19:54:37 UTC</span>

<span style="font-size: 90%;">Good point!</span>

**azurIt** <span style="color: grey; font-size: 90%;">19:54:54 UTC</span>

<span style="font-size: 90%;">Another option would be to make crs-setup.conf mandatory.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:55:16 UTC</span>

<span style="font-size: 90%;">Please explain this _@azurIt_.</span>

**azurIt** <span style="color: grey; font-size: 90%;">19:55:53 UTC</span>

<span style="font-size: 90%;">It must exists for CRS to work. Then initialization will be done inside crs-setup.conf.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:56:41 UTC</span>

<span style="font-size: 90%;">Ah, that means all the initialization moves from 901 into crs-setup.conf. Yes, that could be a perspective.</span>

**azurIt** <span style="color: grey; font-size: 90%;">19:57:03 UTC</span>

<span style="font-size: 90%;">Will make updates more complicated but maybe it can be resolved somehow.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:57:05 UTC</span>

<span style="font-size: 90%;">I personally find this is such a big step, we should be very careful and postpone it to 4.1. If at all.</span>

**dune73** <span style="color: grey; font-size: 90%;">19:58:11 UTC</span>

<span style="font-size: 90%;">Anyways, can we live with the ugly workaround for 4.0 or do we need to come up with a clean solution (potentially re-working quite a few of the plugins again).</span>

**dune73** <span style="color: grey; font-size: 90%;">19:58:21 UTC</span>

<span style="font-size: 90%;">(Don't take this as a threat ... )</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:01:34 UTC</span>

<span style="font-size: 90%;">I would go with our ugly workaround (i don't see it as a big deal) but _@walter_ had a good point about changing plugins infrastructure right in the next (major) release - i don't like it, too. Especially if we already know about the problem.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:01:42 UTC</span>

<span style="font-size: 90%;">I do not see any disagree. So is this positive?</span>

**dune73** <span style="color: grey; font-size: 90%;">20:01:55 UTC</span>

<span style="font-size: 90%;">Thank you _@azurIt_.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:02:39 UTC</span>

<span style="font-size: 90%;">We need to be careful, there. No question. But honestly, we can hardly promise that plugins are set in stone from now on. It's all very new and the creation has not been smooth.</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:02:40 UTC</span>

<span style="font-size: 90%;">I agree. If we're already thinking about major changes in 4.1 then I don't see why we have to force this now.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:03:35 UTC</span>

<span style="font-size: 90%;">Can be guarantee that plugins created for 4.0 will work also in 4.1?</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:03:51 UTC</span>

<span style="font-size: 90%;">If they don't then we fix them.</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:04:03 UTC</span>

<span style="font-size: 90%;">It would be a different question if there were 10s of third-party plugins right now, but there aren't.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:04:49 UTC</span>

<span style="font-size: 90%;">@azuritwe set tx.crs_setup_version=400in crs-setup.conf. It's easy to make sure a plugin behaves differently depending on the crs version.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:04:51 UTC</span>

<span style="font-size: 90%;">That's not a solution, not everyone wants to update whole CRS but updating plugins will, probably, not be so painfull.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:05:19 UTC</span>

<span style="font-size: 90%;">(i will was reacting on _@xanadu_)</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:05:34 UTC</span>

<span style="font-size: 90%;">_@xanadu_ But maybe there will be after we release 4.0.</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:05:55 UTC</span>

<span style="font-size: 90%;">Then that's a different scenario and we re-assess at the time.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:06:53 UTC</span>

<span style="font-size: 90%;">OK, I guess that's settled for now.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:07:23 UTC</span>

<span style="font-size: 90%;">There was a msg here in the channel a few days back, where the Coraza guys asked us about using [https://github.com/jcchavezs/coraza-httpbin](https://github.com/jcchavezs/coraza-httpbin) as CRs playground.</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:08:40 UTC</span>

<span style="font-size: 90%;">This setup is the simplest as it does not depend on any proxy, it is httpbin with a coraza middleware which is the same mechanics but a single deployable.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:07:42 UTC</span>

<span style="font-size: 90%;">_@franbuehler_ you looked into this, did not you? (I skipped the conversation ...)</span>

↳ **franbuehler** <span style="color: grey; font-size: 90%;">20:09:31 UTC</span>

<span style="font-size: 90%;">I didn't look into this and I don't know if this can be used in our CRS sandbox. I would be glad if Max or Felipe had an opinion. Maybe they already talked about it.
And if needed, I can have a look at it, sure!</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:07:52 UTC</span>

<span style="font-size: 90%;">Well, i don't want to go against everyone but i must say i don't like how it'g going to be resolved.</span>

**JC** <span style="color: grey; font-size: 90%;">20:08:01 UTC</span>

<span style="font-size: 90%;">:wave:</span>

**walter** <span style="color: grey; font-size: 90%;">20:08:35 UTC</span>

<span style="font-size: 90%;">_@azurIt_ What would you say is the main problem?</span>

**JC** <span style="color: grey; font-size: 90%;">20:08:40 UTC</span>

<span style="font-size: 90%;">This setup is the simplest as it does not depend on any proxy, it is httpbin with a coraza middleware which is the same mechanics but a single deployable.</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:08:40 UTC</span>

<span style="font-size: 90%;">This setup is the simplest as it does not depend on any proxy, it is httpbin with a coraza middleware which is the same mechanics but a single deployable.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:08:49 UTC</span>

<span style="font-size: 90%;">_@walter_</span>

**dune73** <span style="color: grey; font-size: 90%;">20:08:53 UTC</span>

<span style="font-size: 90%;">Point taken _@azurIt_. I'm sorry, but we need to take a decision and everything else seems more risky right now.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:09:30 UTC</span>

<span style="font-size: 90%;">_@walter_ That we know about the problem and we know plugins are going to change (maybe in backward incompatible way).</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:11:47 UTC</span>

<span style="font-size: 90%;">Ack. Well, I’m not sure they are going to change, I find it hard to think of examples (although there surely might be) but the trick with looking at tx.crs_setup_version could be used in plugins if there really becomes a material difference.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:13:29 UTC</span>

<span style="font-size: 90%;">But plugins can't read that before phase 1.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:14:32 UTC</span>

<span style="font-size: 90%;">I don’t understand, [crs-setup.conf ](http://crs-setup.it)is set in phase 1 before the plugins run?</span>

↳ **dune73** <span style="color: grey; font-size: 90%;">20:14:35 UTC</span>

<span style="font-size: 90%;">Plugins run after crs-setup.conf.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:14:47 UTC</span>

<span style="font-size: 90%;">Is having crs-setup.conf mandatory?</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:14:53 UTC</span>

<span style="font-size: 90%;">Yes</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:15:29 UTC</span>

<span style="font-size: 90%;">If the crs_setup_version variable is not there, the first thing 901 will do is give a status 500 with the log “msg:‘ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions’”</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:16:03 UTC</span>

<span style="font-size: 90%;">Ok, got it.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:18:04 UTC</span>

<span style="font-size: 90%;">I still consider moving initialization before plugins as a best solution.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:22:22 UTC</span>

<span style="font-size: 90%;">This is a tough question. I do think it has advantages because then the plugins can rely on stable initialized variables always. It would require an additional require and 901 would have to be moved maybe to ‘../crs-start.conf’. I’m not totally against it. So now I’m in doubt. (Sorry for messing up the chat about the Coraza topic)</span>

**franbuehler** <span style="color: grey; font-size: 90%;">20:09:31 UTC</span>

<span style="font-size: 90%;">I didn't look into this and I don't know if this can be used in our CRS sandbox. I would be glad if Max or Felipe had an opinion. Maybe they already talked about it.
And if needed, I can have a look at it, sure!</span>

↳ **franbuehler** <span style="color: grey; font-size: 90%;">20:09:31 UTC</span>

<span style="font-size: 90%;">I didn't look into this and I don't know if this can be used in our CRS sandbox. I would be glad if Max or Felipe had an opinion. Maybe they already talked about it.
And if needed, I can have a look at it, sure!</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:10:27 UTC</span>

<span style="font-size: 90%;">(Let's wait for the previous topic to finish)</span>

**franbuehler** <span style="color: grey; font-size: 90%;">20:10:35 UTC</span>

<span style="font-size: 90%;">(Good point)</span>

**walter** <span style="color: grey; font-size: 90%;">20:11:47 UTC</span>

<span style="font-size: 90%;">Ack. Well, I’m not sure they are going to change, I find it hard to think of examples (although there surely might be) but the trick with looking at tx.crs_setup_version could be used in plugins if there really becomes a material difference.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:11:47 UTC</span>

<span style="font-size: 90%;">Ack. Well, I’m not sure they are going to change, I find it hard to think of examples (although there surely might be) but the trick with looking at tx.crs_setup_version could be used in plugins if there really becomes a material difference.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:13:29 UTC</span>

<span style="font-size: 90%;">But plugins can't read that before phase 1.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:14:32 UTC</span>

<span style="font-size: 90%;">I don’t understand, [crs-setup.conf ](http://crs-setup.it)is set in phase 1 before the plugins run?</span>

↳ **dune73** <span style="color: grey; font-size: 90%;">20:14:35 UTC</span>

<span style="font-size: 90%;">Plugins run after crs-setup.conf.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:14:47 UTC</span>

<span style="font-size: 90%;">Is having crs-setup.conf mandatory?</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:14:53 UTC</span>

<span style="font-size: 90%;">Yes</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:15:29 UTC</span>

<span style="font-size: 90%;">If the crs_setup_version variable is not there, the first thing 901 will do is give a status 500 with the log “msg:‘ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions’”</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:16:03 UTC</span>

<span style="font-size: 90%;">Ok, got it.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:18:04 UTC</span>

<span style="font-size: 90%;">I still consider moving initialization before plugins as a best solution.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:22:22 UTC</span>

<span style="font-size: 90%;">This is a tough question. I do think it has advantages because then the plugins can rely on stable initialized variables always. It would require an additional require and 901 would have to be moved maybe to ‘../crs-start.conf’. I’m not totally against it. So now I’m in doubt. (Sorry for messing up the chat about the Coraza topic)</span>

**dune73** <span style="color: grey; font-size: 90%;">20:12:23 UTC</span>

<span style="font-size: 90%;">I do not think plugins will be backwards incompatible. But I don't rule out changes to the way the initialize variables or the way they are included in the config. Namely the order.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:17:56 UTC</span>

<span style="font-size: 90%;">Ok, I think we can continue.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:18:08 UTC</span>

<span style="font-size: 90%;">Thank you _@azurIt_.</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:18:43 UTC</span>

<span style="font-size: 90%;">_@fzipitria_ Maybe you can jump in here.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:18:45 UTC</span>

<span style="font-size: 90%;">OK, what I do not get about the playground is that we use the proxy mainly to work with a single URL for all backends.</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:19:17 UTC</span>

<span style="font-size: 90%;">We used to have a Coraza sandbox backend. What happened to that?
Would this new option be easier/simpler than the old Coraza backend?</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:20:17 UTC</span>

<span style="font-size: 90%;">Easier to deploy (single app), easier to maintain (no more depending on caddy connector being updated) and faster (no latency added by a proxy)</span>

↳ **xanadu** <span style="color: grey; font-size: 90%;">20:20:55 UTC</span>

<span style="font-size: 90%;">Ah, that makes sense. Thank you!</span>

**dune73** <span style="color: grey; font-size: 90%;">20:19:23 UTC</span>

<span style="font-size: 90%;">Or let's say that's one of the two main functionalities. With the 2nd being enriching the response with the CRS alert messages. it's the latter that the Coraza Playground facilitates. Correct?</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:20:32 UTC</span>

<span style="font-size: 90%;">Sorry, can we get some naming definitions out of the way please?</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:20:40 UTC</span>

<span style="font-size: 90%;">What do you mean by playground?</span>

**dune73** <span style="color: grey; font-size: 90%;">20:20:46 UTC</span>

<span style="font-size: 90%;">_@theMiddle_: Can you tell us about the status of the sandbox coraza backend? (I think it died)</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:21:31 UTC</span>

<span style="font-size: 90%;">yep, we commented it out from the composer configuration because of many problem on running the base image with caddy</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:21:51 UTC</span>

<span style="font-size: 90%;">This is the point of this new app, no more depending on caddy.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:21:49 UTC</span>

<span style="font-size: 90%;">Got you, thanks.</span>

**walter** <span style="color: grey; font-size: 90%;">20:22:22 UTC</span>

<span style="font-size: 90%;">This is a tough question. I do think it has advantages because then the plugins can rely on stable initialized variables always. It would require an additional require and 901 would have to be moved maybe to ‘../crs-start.conf’. I’m not totally against it. So now I’m in doubt. (Sorry for messing up the chat about the Coraza topic)</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:11:47 UTC</span>

<span style="font-size: 90%;">Ack. Well, I’m not sure they are going to change, I find it hard to think of examples (although there surely might be) but the trick with looking at tx.crs_setup_version could be used in plugins if there really becomes a material difference.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:13:29 UTC</span>

<span style="font-size: 90%;">But plugins can't read that before phase 1.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:14:32 UTC</span>

<span style="font-size: 90%;">I don’t understand, [crs-setup.conf ](http://crs-setup.it)is set in phase 1 before the plugins run?</span>

↳ **dune73** <span style="color: grey; font-size: 90%;">20:14:35 UTC</span>

<span style="font-size: 90%;">Plugins run after crs-setup.conf.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:14:47 UTC</span>

<span style="font-size: 90%;">Is having crs-setup.conf mandatory?</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:14:53 UTC</span>

<span style="font-size: 90%;">Yes</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:15:29 UTC</span>

<span style="font-size: 90%;">If the crs_setup_version variable is not there, the first thing 901 will do is give a status 500 with the log “msg:‘ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions’”</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:16:03 UTC</span>

<span style="font-size: 90%;">Ok, got it.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:18:04 UTC</span>

<span style="font-size: 90%;">I still consider moving initialization before plugins as a best solution.</span>

↳ **walter** <span style="color: grey; font-size: 90%;">20:22:22 UTC</span>

<span style="font-size: 90%;">This is a tough question. I do think it has advantages because then the plugins can rely on stable initialized variables always. It would require an additional require and 901 would have to be moved maybe to ‘../crs-start.conf’. I’m not totally against it. So now I’m in doubt. (Sorry for messing up the chat about the Coraza topic)</span>

**franbuehler** <span style="color: grey; font-size: 90%;">20:22:29 UTC</span>

<span style="font-size: 90%;">Could this new proposal by JC be an option?</span>

**dune73** <span style="color: grey; font-size: 90%;">20:22:31 UTC</span>

<span style="font-size: 90%;">Slowly making sense of this. So the proposal is to use the playground as a replacement for the sandbox coraza backend?</span>

**JC** <span style="color: grey; font-size: 90%;">20:22:42 UTC</span>

<span style="font-size: 90%;">Yes.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:23:05 UTC</span>

<span style="font-size: 90%;">Not a proposal to run the playground as a proxy-less alternative to the sandbox. I got this wrong.</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:23:17 UTC</span>

<span style="font-size: 90%;">Sorry, again: what is the playground? </span>

**maxleske** <span style="color: grey; font-size: 90%;">20:25:08 UTC</span>

<span style="font-size: 90%;">No one wants to know :smile:</span>

**dune73** <span style="color: grey; font-size: 90%;">20:25:16 UTC</span>

<span style="font-size: 90%;">I understand it as a Coraza gimmick that allows you to run Coraza and CRS in a minimalistic, playgroundlike way. (But I admit I make this up as I move along.)</span>

**dune73** <span style="color: grey; font-size: 90%;">20:25:41 UTC</span>

<span style="font-size: 90%;">_@JC_ please confirm or improve. :slightly_smiling_face:</span>

**JC** <span style="color: grey; font-size: 90%;">20:26:30 UTC</span>

<span style="font-size: 90%;">so coraza-httpbin is an app which runs httpbin and coraza as reverse proxy. The main idea is to be able to try requests against this app</span>

**JC** <span style="color: grey; font-size: 90%;">20:26:38 UTC</span>

<span style="font-size: 90%;">This will embed CRS</span>

**JC** <span style="color: grey; font-size: 90%;">20:27:46 UTC</span>

<span style="font-size: 90%;">The main advantage is that given it uses the http middleware, it is crazy easy to update it. It is also crazy easy to update CRS as it will use coraza-coreruleset abstraction and finally, it is crazy easy to deploy as it is a single container</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:28:00 UTC</span>

<span style="font-size: 90%;">So it's like modsecurity-crs-docker with Coraza?</span>

**JC** <span style="color: grey; font-size: 90%;">20:28:06 UTC</span>

<span style="font-size: 90%;">Yes</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:28:14 UTC</span>

<span style="font-size: 90%;">Ok, thanks</span>

**dune73** <span style="color: grey; font-size: 90%;">20:28:22 UTC</span>

<span style="font-size: 90%;">_@theMiddle_ do you see problems integrating such an architecture with the sandbox?</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:29:13 UTC</span>

<span style="font-size: 90%;">I don't see problems, if is there a Dockerfile or a official docker image on docker hub, I can do it easily</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:29:53 UTC</span>

<span style="font-size: 90%;">[https://github.com/jcchavezs/coraza-httpbin/pkgs/container/coraza-httpbin](https://github.com/jcchavezs/coraza-httpbin/pkgs/container/coraza-httpbin)</span>

**JC** <span style="color: grey; font-size: 90%;">20:29:24 UTC</span>

<span style="font-size: 90%;">I think it is important to have coraza in the sandbox to give it a first class concern treatment if the idea is it to be a sister project.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:29:51 UTC</span>

<span style="font-size: 90%;">Absolutely.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:30:25 UTC</span>

<span style="font-size: 90%;">the main point is that coraza should be able to provide JSON audit log to be integrated with the CRS Sandbox, but I think it's not a problem, isn't it?</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:31:33 UTC</span>

<span style="font-size: 90%;">It isn’t I think and if it is we (coraza) must work that out.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:30:33 UTC</span>

<span style="font-size: 90%;">_@theMiddle_ you have other things cooking around the sandbox, if I am not mistaken, or could this be one of the next tasks?</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:30:44 UTC</span>

<span style="font-size: 90%;">Would be interesting to have also our tests running under Coraza.</span>

↳ **JC** <span style="color: grey; font-size: 90%;">20:31:11 UTC</span>

<span style="font-size: 90%;">TOTALLY</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:31:03 UTC</span>

<span style="font-size: 90%;">Should be easy to update the docker-compose file</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:31:35 UTC</span>

<span style="font-size: 90%;">It would be good to have our tests running even on Nginx, to start with :sweat_smile:</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:32:51 UTC</span>

<span style="font-size: 90%;">+1 as in BB, if i remember correctly, was one issue occuring only under Nginx</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:31:40 UTC</span>

<span style="font-size: 90%;">But Coraza too, sure.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:32:14 UTC</span>

<span style="font-size: 90%;">yes my only concern is about parsing the audit log from coraza, but it's not a big deal</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:32:47 UTC</span>

<span style="font-size: 90%;">I'll try to integrate it on sandbox during the week</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:32:49 UTC</span>

<span style="font-size: 90%;">I'll update our docker-compose</span>

**dune73** <span style="color: grey; font-size: 90%;">20:33:10 UTC</span>

<span style="font-size: 90%;">Sounds cool. So we give it a try and ideally, Coraza backend comes back.</span>

**JC** <span style="color: grey; font-size: 90%;">20:33:24 UTC</span>

<span style="font-size: 90%;">Awesome</span>

**dune73** <span style="color: grey; font-size: 90%;">20:33:51 UTC</span>

<span style="font-size: 90%;">Good. Last point on the official agenda.
Status of the grand keyword list overhaul.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:33:52 UTC</span>

<span style="font-size: 90%;">[https://github.com/coreruleset/coreruleset/issues/2621](https://github.com/coreruleset/coreruleset/issues/2621)</span>

**dune73** <span style="color: grey; font-size: 90%;">20:34:09 UTC</span>

<span style="font-size: 90%;">For the record: It's the biggest mountain left before CRSv4.</span>

↳ **airween** <span style="color: grey; font-size: 90%;">20:35:01 UTC</span>

<span style="font-size: 90%;">Sorry for the interrupt - what about U9P-230113? Can we close that?</span>

**dune73** <span style="color: grey; font-size: 90%;">20:34:55 UTC</span>

<span style="font-size: 90%;">My UA / scanner lists are making very small steps towards completion. Other issues seem to progress faster.
Unfortunately, there is nothing happening with the PHP keyword lists.</span>

**airween** <span style="color: grey; font-size: 90%;">20:35:01 UTC</span>

<span style="font-size: 90%;">Sorry for the interrupt - what about U9P-230113? Can we close that?</span>

↳ **airween** <span style="color: grey; font-size: 90%;">20:35:01 UTC</span>

<span style="font-size: 90%;">Sorry for the interrupt - what about U9P-230113? Can we close that?</span>

**dune73** <span style="color: grey; font-size: 90%;">20:36:17 UTC</span>

<span style="font-size: 90%;">I'd give them a few more days / weeks. We  - namely I - have not been very speedy either and it does not hurt to keep it open. Better than having to reopen.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:37:53 UTC</span>

<span style="font-size: 90%;">Anybody has an opinion / proposal on the PHP stuff?</span>

**jit(Xhoenix)** <span style="color: grey; font-size: 90%;">20:38:39 UTC</span>

<span style="font-size: 90%;">I think the PHP errors file needs to be revised. Lots of common words there.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:39:50 UTC</span>

<span style="font-size: 90%;">I already did some work on one of the PHP list, i'm able to complete it but i need some guidance.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:40:14 UTC</span>

<span style="font-size: 90%;">That would be awesome _@azurIt_.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:40:15 UTC</span>

<span style="font-size: 90%;">this was my comment about php list [https://github.com/coreruleset/coreruleset/issues/2684#issuecomment-1366597237](https://github.com/coreruleset/coreruleset/issues/2684#issuecomment-1366597237)</span>

**walter** <span style="color: grey; font-size: 90%;">20:40:28 UTC</span>

<span style="font-size: 90%;">I would like to help but sadly due to extreme work pressure after getting covid I can only start helping around mid April.</span>

**walter** <span style="color: grey; font-size: 90%;">20:41:07 UTC</span>

<span style="font-size: 90%;">It definitely needs some work</span>

**walter** <span style="color: grey; font-size: 90%;">20:41:30 UTC</span>

<span style="font-size: 90%;">for instance you wouldn’t find
SyncMutex::lockin a codebase, but probably an object of class SyncMutex and then $object->lock();</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:44:28 UTC</span>

<span style="font-size: 90%;">Yes, this is the main problem i'm can't deal with.</span>

↳ **azurIt** <span style="color: grey; font-size: 90%;">20:44:38 UTC</span>

<span style="font-size: 90%;">See [https://github.com/coreruleset/coreruleset/issues/2684#issuecomment-1407407907](https://github.com/coreruleset/coreruleset/issues/2684#issuecomment-1407407907)</span>

**dune73** <span style="color: grey; font-size: 90%;">20:41:42 UTC</span>

<span style="font-size: 90%;">2684 is also where _@azurIt_ misses some guidance. Can somebody take him by the hand - ideally before mid April?</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:42:51 UTC</span>

<span style="font-size: 90%;">not taking by hand but I'm available for commenting and bringing down the morale :smile:</span>

**walter** <span style="color: grey; font-size: 90%;">20:44:13 UTC</span>

<span style="font-size: 90%;">I used to create the PHP list based on what I saw most in uploaded malware logs and considered usable functions (e.g. read/write files, communicate). I don’t see much value in detecting a mutex lock since malware probably doesn’t have a good use for this.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:44:23 UTC</span>

<span style="font-size: 90%;">I think that's all we can ask from you without offending your girlfriend.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:46:39 UTC</span>

<span style="font-size: 90%;">_@azurIt_: Would you mind self-assign the PHP issues that you can take over.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:47:06 UTC</span>

<span style="font-size: 90%;">It would be really good if we could make sure this does not fall back into Walter's lap in the current situation.</span>

**walter** <span style="color: grey; font-size: 90%;">20:47:22 UTC</span>

<span style="font-size: 90%;">I’d like to review though!</span>

**walter** <span style="color: grey; font-size: 90%;">20:47:35 UTC</span>

<span style="font-size: 90%;">So I will try to keep my eyes on it as it develops as much as possible</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:47:49 UTC</span>

<span style="font-size: 90%;">I can assign at least [https://github.com/coreruleset/coreruleset/issues/2684](https://github.com/coreruleset/coreruleset/issues/2684) but it's already assigned to _@fzipitria_.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:48:16 UTC</span>

<span style="font-size: 90%;">I think 90% of github is assigned to _@fzipitria_</span>

**dune73** <span style="color: grey; font-size: 90%;">20:49:05 UTC</span>

<span style="font-size: 90%;">Feel free to grab it from him. He's very pleased with any keyword list items not on his desk.</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:49:34 UTC</span>

<span style="font-size: 90%;">Ok, i kicked him out of that one issue.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:49:57 UTC</span>

<span style="font-size: 90%;">:slightly_smiling_face:</span>

**dune73** <span style="color: grey; font-size: 90%;">20:50:21 UTC</span>

<span style="font-size: 90%;">There is a comment the 4 PHP list issues have to be done together.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:50:26 UTC</span>

<span style="font-size: 90%;">e..g in [#3021](https://github.com/coreruleset/coreruleset/issues/#3021)</span>

**dune73** <span style="color: grey; font-size: 90%;">20:51:02 UTC</span>

<span style="font-size: 90%;">Is it something you _@azurIt_ could do together with _@jit(Xhoenix)_? The other PHP issues I mean...</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:51:44 UTC</span>

<span style="font-size: 90%;">Where can i find that comment? :smile:</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:52:00 UTC</span>

<span style="font-size: 90%;">Ok, you got me, i can't promise it but i will try to look at it.</span>

**dune73** <span style="color: grey; font-size: 90%;">20:52:17 UTC</span>

<span style="font-size: 90%;">_@jit(Xhoenix)_ what do you think?</span>

**dune73** <span style="color: grey; font-size: 90%;">20:52:20 UTC</span>

<span style="font-size: 90%;">-> [https://github.com/coreruleset/coreruleset/issues/3021](https://github.com/coreruleset/coreruleset/issues/3021)</span>

↳ **jit(Xhoenix)** <span style="color: grey; font-size: 90%;">20:57:31 UTC</span>

<span style="font-size: 90%;">Sir, I think that's a bit complicated way to doing things.</span>

**jit(Xhoenix)** <span style="color: grey; font-size: 90%;">20:53:02 UTC</span>

<span style="font-size: 90%;">_@azurIt_ I just commented on [#2684](https://github.com/coreruleset/coreruleset/issues/#2684)</span>

**dune73** <span style="color: grey; font-size: 90%;">20:54:48 UTC</span>

<span style="font-size: 90%;">Great stuff. Thanks.
With that I think we are mostly done. Unless _@JC_ has something to add.</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:00:12 UTC</span>

<span style="font-size: 90%;">yep, coraza twitter account is up [https://twitter.com/corazaio](https://twitter.com/corazaio)</span>

**azurIt** <span style="color: grey; font-size: 90%;">20:55:13 UTC</span>

<span style="font-size: 90%;">(maybe some Coraza stickers for my daughter)</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:55:46 UTC</span>

<span style="font-size: 90%;">:coraza-party:</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:55:49 UTC</span>

<span style="font-size: 90%;">sorry didn't add to the meeting agenda, but 3163 it's something critical</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:56:23 UTC</span>

<span style="font-size: 90%;">I mean, fixable but it require a decision</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:57:07 UTC</span>

<span style="font-size: 90%;">ua and referer, inspect or not inspect that's the question</span>

**dune73** <span style="color: grey; font-size: 90%;">20:57:22 UTC</span>

<span style="font-size: 90%;">Oops. Let's take that in then.</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:57:32 UTC</span>

<span style="font-size: 90%;">Didn't we only just add inspection of Referer and UA headers?</span>

↳ **theMiddle** <span style="color: grey; font-size: 90%;">20:58:44 UTC</span>

<span style="font-size: 90%;">yes and I'm testing it on some production websites, and there're many FP on UA and Referer</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:57:40 UTC</span>

<span style="font-size: 90%;">(_@JC_ _@Matteo Pace_ [https://github.com/coreruleset/coreruleset/issues/3163#issuecomment-1475412139](https://github.com/coreruleset/coreruleset/issues/3163#issuecomment-1475412139))</span>

**maxleske** <span style="color: grey; font-size: 90%;">20:58:01 UTC</span>

<span style="font-size: 90%;">Yes, that's why the FP occurred</span>

**walter** <span style="color: grey; font-size: 90%;">20:58:35 UTC</span>

<span style="font-size: 90%;">ouch</span>

**theMiddle** <span style="color: grey; font-size: 90%;">20:58:44 UTC</span>

<span style="font-size: 90%;">yes and I'm testing it on some production websites, and there're many FP on UA and Referer</span>

↳ **theMiddle** <span style="color: grey; font-size: 90%;">20:58:44 UTC</span>

<span style="font-size: 90%;">yes and I'm testing it on some production websites, and there're many FP on UA and Referer</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:59:23 UTC</span>

<span style="font-size: 90%;">We had to add inspection to close many of the bug bounty issues, is that right? So there is no question, they must be inspected?</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:00:04 UTC</span>

<span style="font-size: 90%;">yes</span>

**dune73** <span style="color: grey; font-size: 90%;">20:59:35 UTC</span>

<span style="font-size: 90%;">I do not get so many FPs in this regard in production, but my traffic is probably lower.</span>

**xanadu** <span style="color: grey; font-size: 90%;">20:59:49 UTC</span>

<span style="font-size: 90%;">Or we just need many exceptions?</span>

**JC** <span style="color: grey; font-size: 90%;">21:00:12 UTC</span>

<span style="font-size: 90%;">yep, coraza twitter account is up [https://twitter.com/corazaio](https://twitter.com/corazaio)</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:00:12 UTC</span>

<span style="font-size: 90%;">yep, coraza twitter account is up [https://twitter.com/corazaio](https://twitter.com/corazaio)</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:00:26 UTC</span>

<span style="font-size: 90%;">we had to, but the way we're doing it can't be the solution IMO</span>

**dune73** <span style="color: grey; font-size: 90%;">21:00:34 UTC</span>

<span style="font-size: 90%;">Yes, we expanded the inspection over BB issues and after experiences with log4j etc. More and more attacks working via UA + Referer that we detect as soon as we start to inspect it. But it's true that it can cause FPs. Obviously.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:00:47 UTC</span>

<span style="font-size: 90%;">we just add the two header to rules designed to inspect ARGS</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:00:50 UTC</span>

<span style="font-size: 90%;">The FP occurs at PL2 though...</span>

**dune73** <span style="color: grey; font-size: 90%;">21:00:59 UTC</span>

<span style="font-size: 90%;">UA: What funny UAs trigger the FPs? Big browsers that we could work around, or random agents?</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:01:14 UTC</span>

<span style="font-size: 90%;">letsencrypt it's really common</span>

**dune73** <span style="color: grey; font-size: 90%;">21:01:36 UTC</span>

<span style="font-size: 90%;">Yes, but let's encrypt is not the only problem you have.</span>

**dune73** <span style="color: grey; font-size: 90%;">21:01:53 UTC</span>

<span style="font-size: 90%;">I mean we can work around let's encrypt, I am sure. But the problem is bigger, is not it.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:04:08 UTC</span>

<span style="font-size: 90%;">yes, but the uglyness of some FP makes me think that UA cannot be inspected with generic injection rules. It's quite a full text input and nobody follow the standard (except for browsers... maybe)</span>

**dune73** <span style="color: grey; font-size: 90%;">21:05:03 UTC</span>

<span style="font-size: 90%;">Hmm. Maybe you have a point there. But it would really help if you could provide us with a list of UA FPs on the injection rules.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:05:20 UTC</span>

<span style="font-size: 90%;">that's true, sorry for being late on this</span>

**franbuehler** <span style="color: grey; font-size: 90%;">21:05:28 UTC</span>

<span style="font-size: 90%;">It seems I have to revert some of my changes to fix these bypasses....</span>

**franbuehler** <span style="color: grey; font-size: 90%;">21:05:48 UTC</span>

<span style="font-size: 90%;">Yes, maybe we have to wait for this list.</span>

**walter** <span style="color: grey; font-size: 90%;">21:05:49 UTC</span>

<span style="font-size: 90%;">I was thinking about this problem under the shower and I was balancing, what are we protecting, and who are we harming. We are protecting UA logging systems but FPs harm everyone.</span>

**azurIt** <span style="color: grey; font-size: 90%;">21:05:56 UTC</span>

<span style="font-size: 90%;">I mostly agree with _@theMiddle_, we cannot  treat Referer as other, parsed and very specific, variables.</span>

**xanadu** <span style="color: grey; font-size: 90%;">21:06:20 UTC</span>

<span style="font-size: 90%;">Move the UA rules to PL 3?</span>

**xanadu** <span style="color: grey; font-size: 90%;">21:06:33 UTC</span>

<span style="font-size: 90%;">Want to protect your logging system => PL 3</span>

**dune73** <span style="color: grey; font-size: 90%;">21:06:48 UTC</span>

<span style="font-size: 90%;">FPs harm everyone, so we should steer clear of that on PL1. But at PL2 and PL3 I expect some protection in this direction.</span>

**dune73** <span style="color: grey; font-size: 90%;">21:07:06 UTC</span>

<span style="font-size: 90%;">_@xanadu_ that could be interesting to add character / use to PL3.</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:07:41 UTC</span>

<span style="font-size: 90%;">Let's wait for a list. I just looked at the FP and it is because it matches let' in let's encrypt. That is fairly specific.</span>

**walter** <span style="color: grey; font-size: 90%;">21:08:09 UTC</span>

<span style="font-size: 90%;">Yes, but if the FPs are too many (there are many clients, like SEO tools, etc.) then people will get tired of running PL2. If UAs are such a problem then I (with my user hat on) would think PL3 is a good place.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:08:30 UTC</span>

<span style="font-size: 90%;">also UA from mobile phone... they are really creative</span>

**walter** <span style="color: grey; font-size: 90%;">21:08:38 UTC</span>

<span style="font-size: 90%;">Yes they are crazy</span>

**azurIt** <span style="color: grey; font-size: 90%;">21:09:00 UTC</span>

<span style="font-size: 90%;">_@maxleske_ I was looking at it, too, and it's only because of '.</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:09:25 UTC</span>

<span style="font-size: 90%;">yes, you're right</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:09:29 UTC</span>

<span style="font-size: 90%;">Just realised that too</span>

**dune73** <span style="color: grey; font-size: 90%;">21:10:07 UTC</span>

<span style="font-size: 90%;">I agree it's the volume and variety of FPs. Maybe shifting them to PL3 is the way to go.</span>

**dune73** <span style="color: grey; font-size: 90%;">21:10:27 UTC</span>

<span style="font-size: 90%;">_@theMiddle_ OK if we wait for your list and then make a proposal how to resolve in a systematic way?</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:10:44 UTC</span>

<span style="font-size: 90%;">We can still make a distinction between known command words and generic RCE injection</span>

**azurIt** <span style="color: grey; font-size: 90%;">21:10:50 UTC</span>

<span style="font-size: 90%;">But we can't block Let's Encrypt even on PL2 i think.</span>

**azurIt** <span style="color: grey; font-size: 90%;">21:11:14 UTC</span>

<span style="font-size: 90%;">Currently, it's something like a standard for web.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:11:22 UTC</span>

<span style="font-size: 90%;">ok for me, I hope to manage to collect and aggregate the past fp but I've all the data so... I can do it</span>

**walter** <span style="color: grey; font-size: 90%;">21:11:24 UTC</span>

<span style="font-size: 90%;">Agree, we can’t break LE on PL2, it’s too common, almost every user would have to write an exclusion.</span>

**azurIt** <span style="color: grey; font-size: 90%;">21:11:34 UTC</span>

<span style="font-size: 90%;">You can't offer webhosting services without it.</span>

**dune73** <span style="color: grey; font-size: 90%;">21:12:11 UTC</span>

<span style="font-size: 90%;">Good, so we have a plan here to.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:12:42 UTC</span>

<span style="font-size: 90%;">to be clear, this situation wasn't clear when we changed those rules obv...</span>

**dune73** <span style="color: grey; font-size: 90%;">21:12:56 UTC</span>

<span style="font-size: 90%;">We have taken notice of [https://twitter.com/corazaio](https://twitter.com/corazaio). So I guess this meeting is coming to an end.</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:13:00 UTC</span>

<span style="font-size: 90%;">only after testing it we realize them</span>

**dune73** <span style="color: grey; font-size: 90%;">21:13:06 UTC</span>

<span style="font-size: 90%;">_@theMiddle_ I think we had it coming ...</span>

**walter** <span style="color: grey; font-size: 90%;">21:13:24 UTC</span>

<span style="font-size: 90%;">well that’s the value of testing :partying_face:</span>

**dune73** <span style="color: grey; font-size: 90%;">21:13:30 UTC</span>

<span style="font-size: 90%;">I for one am not overly surprised by this development. But that's why we test things.</span>

**JC** <span style="color: grey; font-size: 90%;">21:13:36 UTC</span>

<span style="font-size: 90%;">One important thing: We have this issue [https://github.com/corazawaf/coraza/issues/688](https://github.com/corazawaf/coraza/issues/688) and I wonder if from CRS perspective we could do it more resilient and do the conversion that _@Anuraag Agrawal_ proposes: [https://github.com/corazawaf/coraza/issues/688#issuecomment-1457867042](https://github.com/corazawaf/coraza/issues/688#issuecomment-1457867042)</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:17:05 UTC</span>

<span style="font-size: 90%;">I don't think that would work for the particular test case you're looking at. ASCII doesn't contain those bytes.</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:18:58 UTC</span>

<span style="font-size: 90%;">Also, It's not invalid UTF-8. Those are valid sequences.</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:19:21 UTC</span>

<span style="font-size: 90%;">(I think...)</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:19:31 UTC</span>

<span style="font-size: 90%;">Thanks _@maxleske_ could you please come by to the issue with those comments?</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:19:56 UTC</span>

<span style="font-size: 90%;">I need to get some sleep first :slightly_smiling_face: I'll check it out tomorrow.</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:21:27 UTC</span>

<span style="font-size: 90%;">Thank you!</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:13:50 UTC</span>

<span style="font-size: 90%;">I mean, it's not our fault, it was just hard to imagine</span>

**dune73** <span style="color: grey; font-size: 90%;">21:15:39 UTC</span>

<span style="font-size: 90%;">Agreed. Sometimes you need to test things. (note to self: That HTTP headers value zoo would be soooo useful)</span>

**dune73** <span style="color: grey; font-size: 90%;">21:16:54 UTC</span>

<span style="font-size: 90%;">So we close this unless something pops up last minute?</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:17:19 UTC</span>

<span style="font-size: 90%;">U_U [https://owasp.slack.com/archives/CBKGH8A5P/p1679346816653849](https://owasp.slack.com/archives/CBKGH8A5P/p1679346816653849)</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:17:05 UTC</span>

<span style="font-size: 90%;">I don't think that would work for the particular test case you're looking at. ASCII doesn't contain those bytes.</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:17:05 UTC</span>

<span style="font-size: 90%;">I don't think that would work for the particular test case you're looking at. ASCII doesn't contain those bytes.</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:18:58 UTC</span>

<span style="font-size: 90%;">Also, It's not invalid UTF-8. Those are valid sequences.</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:19:21 UTC</span>

<span style="font-size: 90%;">(I think...)</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:19:31 UTC</span>

<span style="font-size: 90%;">Thanks _@maxleske_ could you please come by to the issue with those comments?</span>

↳ **maxleske** <span style="color: grey; font-size: 90%;">21:19:56 UTC</span>

<span style="font-size: 90%;">I need to get some sleep first :slightly_smiling_face: I'll check it out tomorrow.</span>

↳ **JC** <span style="color: grey; font-size: 90%;">21:21:27 UTC</span>

<span style="font-size: 90%;">Thank you!</span>

**dune73** <span style="color: grey; font-size: 90%;">21:20:56 UTC</span>

<span style="font-size: 90%;">OK, so thank you all for joining then. And if anybody feels like helping out Coraza ...</span>

**dune73** <span style="color: grey; font-size: 90%;">21:21:09 UTC</span>

<span style="font-size: 90%;">See you in early April at the latest.</span>

**franbuehler** <span style="color: grey; font-size: 90%;">21:21:30 UTC</span>

<span style="font-size: 90%;">Good night!</span>

**maxleske** <span style="color: grey; font-size: 90%;">21:21:32 UTC</span>

<span style="font-size: 90%;">bb</span>

**theMiddle** <span style="color: grey; font-size: 90%;">21:21:36 UTC</span>

<span style="font-size: 90%;">:wave:</span>

**JC** <span style="color: grey; font-size: 90%;">21:21:38 UTC</span>

<span style="font-size: 90%;">Good night and thanks everyone</span>

**xanadu** <span style="color: grey; font-size: 90%;">21:21:39 UTC</span>

<span style="font-size: 90%;">Good night!</span>

**azurIt** <span style="color: grey; font-size: 90%;">21:21:46 UTC</span>

<span style="font-size: 90%;">Thanks, it was fun! Good night.</span>

**airween** <span style="color: grey; font-size: 90%;">21:22:01 UTC</span>

<span style="font-size: 90%;">good night</span>

**walter** <span style="color: grey; font-size: 90%;">21:23:56 UTC</span>

<span style="font-size: 90%;">good night!!</span>

**jit(Xhoenix)** <span style="color: grey; font-size: 90%;">21:24:34 UTC</span>

<span style="font-size: 90%;">Good night everyone. :slightly_smiling_face:</span>

